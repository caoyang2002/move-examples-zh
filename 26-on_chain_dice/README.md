# 快速开始

```bash
aptos move test
```

# 解析

这段代码是用 Move 语言编写的，定义了一个名为 `dice` 的模块，用于模拟掷骰子的游戏。以下是代码的主要组成部分和功能的解释：

### 结构体

1. **`DiceRollHistory`**：
    - 这是一个关键的结构体，用作资源来存储用户掷骰子的历史记录。
    - 它包含一个 `rolls` 向量，用于存储每次掷骰子的结果。

### 函数

1. **`roll_v0`**：
    - 这是一个公共入口函数，用于模拟掷骰子的动作。
    - 函数内部调用 `randomness::u64_range(0, 6)` 来生成一个 0 到 5 之间的随机数，模拟掷骰子的结果。
    - 函数没有保存或返回掷骰子的结果。

2. **`roll`**：
    - 这是一个入口函数，用于记录用户掷骰子的结果。
    - 函数首先检查用户是否已经有 `DiceRollHistory` 资源，如果有，则将其移除并更新，如果没有，则创建一个新的 `DiceRollHistory` 实例。
    - 然后，函数生成一个新的随机数，并将其添加到用户的掷骰子历史记录中。
    - 最后，更新后的 `DiceRollHistory` 资源被移动回用户的账户下。

3. **`roll_v2`**：
    - 这是一个入口函数，与 `roll_v0` 类似，但指定了 `max_gas=56789` 属性，这可能用于限制执行该函数时消耗的 gas（计算资源）。
    - 同样，函数生成一个随机数，但未保存或返回结果。

### 属性

- **`#[lint::allow_unsafe_randomness]`**：
    - 这是一个 lint 属性，用于允许在 `roll_v0` 函数中使用不安全的随机数生成。

- **`#[randomness]`**：
    - 这是一个属性，用于指示 `roll` 和 `roll_v2` 函数使用随机数生成器。
    - `roll_v2` 函数中的 `max_gas` 属性用于限制函数执行时的资源消耗。

### 总结

这个模块提供了一个简单的掷骰子游戏的实现，允许用户生成随机数来模拟掷骰子的结果，并将结果记录在用户的账户下。通过 `DiceRollHistory` 资源，用户可以查看他们的历史掷骰子记录。这个模块展示了如何在 Move 语言中使用随机数生成器以及如何管理资源。
